import{r,o as i,k as R,j as e,W as h,ae as W,af as T,aX as z,aY as B,E as p,ak as A,a_ as H,ay as $,bk as K,az as X,cV as O}from"./index.b8b13c58.js";import{E as V}from"./index.7e8188ae.js";import{u as w,a as G}from"./xlsx.8087b80f.js";const J=[{id:1,name:"Leanne Graham",username:"Bret",email:"Sincere@april.biz",website:"hildegard.org"},{id:2,name:"Ervin Howell",username:"Antonette",email:"Shanna@melissa.tv",website:"anastasia.net"},{id:3,name:"Clementine Bauch",username:"Samantha",email:"Nathan@yesenia.net",website:"ramiro.info"},{id:4,name:"Patricia Lebsack",username:"Karianne",email:"Julianne.OConner@kory.org",website:"kale.biz"},{id:5,name:"Chelsey Dietrich",username:"Kamren",email:"Lucio_Hettinger@annie.ca",website:"demarco.info"},{id:6,name:"Mrs. Dennis Schulist",username:"Leopoldo_Corkery",email:"Karley_Dach@jasper.info",website:"ola.org"},{id:7,name:"Kurtis Weissnat",username:"Elwyn.Skiles",email:"Telly.Hoeger@billy.biz",website:"elvis.io"},{id:8,name:"Nicholas Runolfsdottir V",username:"Maxime_Nienow",email:"Sherwood@rosamond.me",website:"jacynthe.com"},{id:9,name:"Glenna Reichert",username:"Delphine",email:"Chaim_McDermott@dana.io",website:"conrad.com"},{id:10,name:"Clementina DuBuque",username:"Moriah.Stanton",email:"Rey.Padberg@karina.biz",website:"ambrose.net"}],Q=()=>{const[l]=r.exports.useState(J),[b,x]=r.exports.useState(""),[C,k]=r.exports.useState(!1),[m,f]=r.exports.useState(""),[L,v]=r.exports.useState([]),[g,N]=r.exports.useState([]),[u,E]=r.exports.useState("xlsx"),[o,S]=r.exports.useState([]),c=()=>k(!C),D=t=>{let s=[];const a=t.target.value;x(a),a.length&&(s=l.filter(n=>{const d=n.name.toLowerCase().startsWith(a.toLowerCase())||n.email.toLowerCase().startsWith(a.toLowerCase())||n.website.toLowerCase().startsWith(a.toLowerCase())||n.id.toString().toLowerCase().startsWith(a.toLowerCase()),y=n.name.toLowerCase().includes(a.toLowerCase())||n.email.toLowerCase().includes(a.toLowerCase())||n.website.toLowerCase().includes(a.toLowerCase())||n.id.toString().toLowerCase().includes(a.toLowerCase());return d||(!d&&y?y:null)}),x(a),v(s))},F=()=>{const t=g;l.map(d=>o.includes(d.id)?t.push(d):null),N([...t]);const s=m.length?`${m}.${u}`:`excel-sheet.${u}`,a=w.json_to_sheet(g),n=w.book_new();w.book_append_sheet(n,a,"test"),G(n,s),c()},_=t=>{const s=o;if(!s.includes(t))s.push(t);else if(s.includes(t))s.splice(s.indexOf(t),1);else return null;S([...s])},M=()=>{let t=o;if(t.length<l.length)t=l.map(a=>a.id);else if(t.length===l.length)t=[];else return null;S(t)},j=(b?L:l).map(t=>i("tr",{className:R({selected:o.includes(t.id)}),children:[e("td",{children:e("div",{className:"form-check",children:e(h,{id:t.id,type:"checkbox",onChange:()=>_(t.id),checked:!!o.includes(t.id)})})}),e("td",{children:t.email}),e("td",{children:t.name}),e("td",{children:t.website}),e("td",{children:t.id})]},t.id));return i(r.exports.Fragment,{children:[e(V,{title:"XLSX",subTitle:"Xlsx is a parser and writer for various spreadsheet formats",link:"https://github.com/SheetJS/sheetjs"}),e(W,{className:"export-component",children:e(T,{sm:"12",children:i(z,{children:[e(B,{className:"pb-0",children:i("div",{className:"d-flex flex-wrap justify-content-between",children:[e(p,{color:"primary",onClick:()=>c(),children:"Export Selected"}),i("div",{className:"d-flex align-items-center justify-content-end",children:[e(A,{for:"search-input",className:"me-1",children:"Search"}),e(h,{id:"search-input",bsSize:"sm",type:"text",value:b,onChange:t=>D(t)})]})]})}),i(H,{className:"table-hover-animation mt-2",responsive:!0,children:[e("thead",{children:i("tr",{children:[e("th",{children:e("div",{className:"form-check",children:e(h,{type:"checkbox",id:"select-all",label:"",checked:!!o.length,onChange:()=>M()})})}),e("th",{children:"Email"}),e("th",{children:"Name"}),e("th",{children:"Website"}),e("th",{children:"Rank"})]})}),e("tbody",{children:j})]})]})})}),i($,{isOpen:C,toggle:()=>c(),className:"modal-dialog-centered",onClosed:()=>f(""),children:[e(K,{toggle:()=>c(),children:"Export To Excel"}),i(X,{children:[e("div",{className:"mb-2",children:e(h,{type:"text",value:m,onChange:t=>f(t.target.value),placeholder:"Enter File Name"})}),e("div",{children:i(h,{type:"select",id:"selectFileFormat",name:"customSelect",value:u,onChange:t=>{E(t.target.value)},children:[e("option",{children:"xlsx"}),e("option",{children:"csv"}),e("option",{children:"txt"})]})})]}),i(O,{children:[e(p,{color:"primary",onClick:()=>F(),children:"Export"}),e(p,{color:"flat-danger",onClick:()=>c(),children:"Cancel"})]})]})]})};export{Q as default};
